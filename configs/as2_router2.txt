enable
configure terminal
ipv6 unicast-routing
ip bgp-community new-format
ipv6 router ospf 1
router-id 2.0.0.2
exit
interface GigabitEthernet1/0
ipv6 enable
ipv6 address 2002:100:2:0::2/64
ip ospf cost 100
no shutdown
ipv6 ospf 1 area 0
exit
interface GigabitEthernet2/0
ipv6 enable
ipv6 address 2002:100:2:2::1/64
ip ospf cost 100
no shutdown
ipv6 ospf 1 area 0
exit
interface FastEthernet0/0
ipv6 enable
ipv6 address 2002:100:2:3::1/64
ip ospf cost 100
no shutdown
ipv6 ospf 1 area 0
exit
interface loopback 0
ipv6 enable
ipv6 address 2::2/128
no shutdown
ipv6 ospf 1 area 0 
exit
interface GigabitEthernet3/0
ipv6 enable
ipv6 address 1000:4::2/64
no shutdown
exit
router bgp 2
no bgp default ipv4-unicast
bgp router-id 2.0.0.2
neighbor 2::1 remote-as 2
neighbor 2::1 update-source Loopback0
neighbor 2::3 remote-as 2
neighbor 2::3 update-source Loopback0
neighbor 2::4 remote-as 2
neighbor 2::4 update-source Loopback0
neighbor 2::5 remote-as 2
neighbor 2::5 update-source Loopback0
neighbor 2::6 remote-as 2
neighbor 2::6 update-source Loopback0
neighbor 2::7 remote-as 2
neighbor 2::7 update-source Loopback0
address-family ipv6 unicast
neighbor 2::1 activate
neighbor 2::1 send-community
neighbor 2::3 activate
neighbor 2::3 send-community
neighbor 2::4 activate
neighbor 2::4 send-community
neighbor 2::5 activate
neighbor 2::5 send-community
neighbor 2::6 activate
neighbor 2::6 send-community
neighbor 2::7 activate
neighbor 2::7 send-community
network 2002:100:2:0::/64
network 2002:100:2:2::/64
network 2002:100:2:3::/64
exit
neighbor 1000:4::4 remote-as 4
address-family ipv6 unicast
neighbor 1000:4::4 activate
neighbor 1000:4::4 
network 1000:4::/64
exit
end
configure terminal
ip community-list standard provider_filter permit 2:10
ip community-list standard peer_filter permit 2:20
route-map non_client_out deny 10
match community provider_filter
exit
route-map non_client_out deny 20
match community peer_filter
exit
route-map non_client_out permit 100
exit
route-map provider_handler permit 10
set community 2:10
set local-preference 50
exit
router bgp 2
address-family ipv6 unicast
neighbor 1000:4::4 route-map non_client_out out
neighbor 1000:4::4 route-map provider_handler in
end
clear bgp ipv6 unicast *