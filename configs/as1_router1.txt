end
enable
configure terminal
router ospf 1
mpls ldp autoconfig
router-id 1.0.0.1
exit
mpls ip
interface GigabitEthernet1/0
ip address 1.0.1.1 255.255.255.248
ip ospf cost 10
no shutdown
ip ospf 1 area 0
mpls ip
exit
interface loopback 0
ip address 1.1.1.1 255.255.255.255
no shutdown
ip ospf 1 area 0 
exit
router bgp 1
neighbor 3.3.3.3 remote-as 1
neighbor 3.3.3.3 update-source Loopback0
address-family vpnv4
neighbor 3.3.3.3 activate
neighbor 3.3.3.3 send-community both
exit-address-family

end
configure terminal
vrf definition Client_A
rd 111:00
route-target export 100:100
route-target import 100:100
route-target import 100:110
exit
interface GigabitEthernet2/0
no shutdown
vrf forwarding Client_A
ip address 253.0.0.1 255.255.255.0
exit
router bgp 1
address-family ipv4 vrf Client_A
neighbor 253.0.0.2 remote-as 11
neighbor 253.0.0.2 activate
exit-address-family
end
configure terminal
route-map Client_A_out permit 10
set community 1:1
set metric 2
exit
router bgp 1
bgp always-compare-med
address-family ipv4 vrf Client_A
neighbor 253.0.0.2 route-map Client_A_out out
end
end
configure terminal
vrf definition Client_B
rd 111:01
route-target export 100:110
route-target import 100:110
route-target import 100:100
exit
interface GigabitEthernet3/0
no shutdown
vrf forwarding Client_B
ip address 253.0.1.1 255.255.255.0
exit
router bgp 1
address-family ipv4 vrf Client_B
neighbor 253.0.1.2 remote-as 16
neighbor 253.0.1.2 activate
exit-address-family
end
configure terminal
route-map Client_B_out permit 10
set community 1:1
set metric 5
exit
router bgp 1
bgp always-compare-med
address-family ipv4 vrf Client_B
neighbor 253.0.1.2 route-map Client_B_out out
end
clear ip bgp *