enable
configure terminal
ipv6 unicast-routing
ip bgp-community new-format
ipv6 router ospf 1
router-id 3.0.0.1
exit
interface GigabitEthernet1/0
ipv6 enable
ipv6 address 2003:100:3:0::1/64
ip ospf cost 100
no shutdown
ipv6 ospf 1 area 0
exit
interface loopback 0
ipv6 enable
ipv6 address 3::1/128
no shutdown
ipv6 ospf 1 area 0 
exit
interface GigabitEthernet3/0
ipv6 enable
ipv6 address 1000:3::3/64
no shutdown
exit
router bgp 3
no bgp default ipv4-unicast
bgp router-id 3.0.0.1
neighbor 3::2 remote-as 3
neighbor 3::2 update-source Loopback0
address-family ipv6 unicast
neighbor 3::2 activate
neighbor 3::2 send-community
network 2003:100:3:0::/64
exit
neighbor 1000:3::2 remote-as 2
address-family ipv6 unicast
neighbor 1000:3::2 activate
neighbor 1000:3::2 
network 1000:3::/64
exit
end
configure terminal
ip community-list standard provider_filter permit 3:10
ip community-list standard peer_filter permit 3:20
route-map non_client_out deny 10
match community provider_filter
exit
route-map non_client_out deny 20
match community peer_filter
exit
route-map non_client_out permit 100
exit
route-map provider_handler permit 10
set community 3:10
set local-preference 50
exit
router bgp 3
address-family ipv6 unicast
neighbor 1000:3::2 route-map non_client_out out
neighbor 1000:3::2 route-map provider_handler in
end
clear bgp ipv6 unicast *